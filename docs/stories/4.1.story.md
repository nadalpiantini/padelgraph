# Story 4.1: Business KPIs Database & Calculations

**Epic**: 4 - Business KPIs
**Story ID**: 4.1
**Priority**: Medium
**Effort**: 4-5 hours

---

## ðŸ“– User Story

**As a** business owner
**I want** key business metrics calculated automatically
**So that** I can track revenue and growth

---

## âœ… Acceptance Criteria

1. KPI calculation functions created
2. DAU/MAU calculation working
3. MRR/ARR calculation from subscriptions
4. Churn rate calculation
5. LTV prediction
6. Cached results for performance
7. API endpoint for KPIs

---

## ðŸ”§ Dev Notes

**File**: `src/lib/analytics/kpis.ts`

**Calculations**:
```typescript
// DAU: Unique users in last 24 hours
// MAU: Unique users in last 30 days
// MRR: Sum of active subscriptions
// ARR: MRR * 12
// Churn: Canceled subscriptions / Total active
// LTV: Average revenue per user lifetime
```

---

## ðŸ“‹ Tasks

1. Create KPI calculation module
2. Implement DAU/MAU queries
3. Implement MRR/ARR from subscriptions
4. Implement churn calculation
5. Implement LTV prediction
6. Create caching layer
7. Create API endpoint
8. Unit tests

---

**Created**: 2025-10-18
